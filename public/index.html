<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Finance Memorandum Generator</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="dot"></div>
          <div>
            <div class="brand-title">Finance Memorandum Generator</div>
            <div class="brand-sub">V2 • Playwright HTML → PDF • Render-ready</div>
          </div>
        </div>
        <div class="actions">
          <button id="btnLoadSample" class="btn btn-ghost" type="button">Load sample</button>
          <button id="btnReset" class="btn btn-ghost" type="button">Reset</button>
          <button id="btnGenerate" class="btn btn-primary" type="button">Generate PDF</button>
        </div>
      </header>

      <main class="shell">
        <aside class="sidebar">
          <div class="segmented" role="tablist" aria-label="Sections">
            <button class="seg" data-tab="cover" role="tab" aria-selected="true">Cover</button>
            <button class="seg" data-tab="parties" role="tab">Parties to the Loan</button>
            <button class="seg" data-tab="legal" role="tab">Legal</button>
            <button class="seg" data-tab="contents" role="tab">Contents</button>
            <button class="seg" data-tab="exec" role="tab">Executive Summary</button>
            <button class="seg" data-tab="proposal" role="tab">Proposal</button>
            <button class="seg" data-tab="sales" role="tab">Sales & Marketing</button>
            <button class="seg" data-tab="lots" role="tab">Pricelist</button>
            <button class="seg" data-tab="property" role="tab">Property Information</button>
            <button class="seg" data-tab="feasibility" role="tab">Feasibility</button>
            <button class="seg" data-tab="loan" role="tab">Loan</button>
            <button class="seg" data-tab="security" role="tab">Security Offered</button>
            <button class="seg" data-tab="borrowers" role="tab">Borrowers</button>
            <button class="seg" data-tab="guarantors" role="tab">Guarantors</button>
            <button class="seg" data-tab="financials" role="tab">Financial Information</button>
            <button class="seg" data-tab="contacts" role="tab">Professional Contacts</button>
            <button class="seg" data-tab="backContacts" role="tab">Contacts</button>
            <button class="seg" data-tab="recommendation" role="tab">Recommendation & Annexures</button>
            <button class="seg" data-tab="footers" role="tab">Footer</button>
          </div>

          <div class="help">
            <div class="help-title">Rules</div>
            <ul class="help-list">
              <li>Only filled fields render into the PDF.</li>
              <li>Sections auto-expand and paginate cleanly.</li>
              <li>Cover image + logo are fully editable.</li>
            </ul>
          </div>
        </aside>

        <section class="panel">
          <div id="status" class="status" hidden></div>

          <form id="form" class="form" autocomplete="off">
            <!-- COVER -->
            <section class="tab" data-tab="cover">
              <h2>Cover</h2>
              <div class="grid2">
                <label class="field"><span>Reference Number</span><input name="meta.referenceNumber" placeholder="e.g., PRP.17213" /></label>
                <label class="field"><span>Date (added to cover)</span><input name="meta.date" placeholder="12 January 2026" /></label>

                <label class="field"><span>Cover main title</span><input name="cover.mainTitle" placeholder="Global Capital Commercial" /></label>
                <label class="field"><span>Cover subheadline line 1</span><input name="cover.subheadline1" placeholder="Confidential" /></label>
                <label class="field"><span>Cover subheadline line 2</span><input name="cover.subheadline2" placeholder="Finance Memorandum" /></label>

                <label class="field"><span>Cover headline</span><input name="cover.headline" placeholder="Construction Finance" /></label>
                <label class="field"><span>Project / Borrower name</span><input name="cover.projectName" placeholder="Warra Project Pty Ltd" /></label>

                <label class="field"><span>Finance required (amount)</span><input name="loan.loanAmount" placeholder="$50,000,000" /></label>
                <label class="field"><span>Prepared By (used on Contacts page)</span><input name="meta.preparedBy" placeholder="Global Capital Commercial" /></label>
              </div>

              <div class="grid2">
                <label class="field"><span>Company website</span><input name="cover.website" placeholder="globalcapital.com.au" /></label>
                <label class="field"><span>Company legal line</span><input name="cover.legalLine" placeholder="Company | ABN | Phone | Email" /></label>
              </div>
              <label class="field"><span>Company address line</span><input name="cover.addressLine" placeholder="Address | PO Box" /></label>

              <div class="grid2">
                <label class="field">
                  <span>Cover Image (Page 1)</span>
                  <input type="file" accept="image/*" name="coverImage" />
                  <small>Smart autoscale: fills if near-perfect ratio, otherwise fits with no cropping.</small>
                </label>
                <label class="field">
                  <span>Overlay Logo image (optional)</span>
                  <input type="file" accept="image/*" name="logo" />
                  <small>Only used if “Show overlay logo” is enabled.</small>
                </label>
              </div>

              <div class="grid2">
                <label class="field"><span>Cover image fit mode</span>
                  <select name="cover.imageFitMode">
                    <option value="smart" selected>Smart (recommended)</option>
                    <option value="contain">Fit (no crop)</option>
                    <option value="cover">Fill (may crop)</option>
                  </select>
                </label>

                <label class="field"><span>Show footer on cover</span>
                  <select name="cover.showFooterOnCover">
                    <option value="false" selected>Off (recommended)</option>
                    <option value="true">On</option>
                  </select>
                </label>
              </div>

              <div class="grid2">
                <label class="field"><span>Show overlay logo</span>
                  <select name="cover.showOverlayLogo">
                    <option value="false" selected>Off</option>
                    <option value="true">On</option>
                  </select>
                </label>

                <label class="field"><span>Show overlay proposal text</span>
                  <select name="cover.showOverlayProposal">
                    <option value="false" selected>Off</option>
                    <option value="true">On</option>
                  </select>
                </label>
              </div>

              <label class="field"><span>Overlay proposal text</span><input name="cover.proposalText" placeholder="PROPOSAL" /></label>
            </section>

            <!-- PARTIES -->
            <section class="tab" data-tab="parties" hidden>
              <div class="rowhead">
                <h2>Parties to the Loan</h2>
                <button type="button" class="btn btn-ghost" data-add="parties">+ Add</button>
              </div>
              <div id="partiesList" class="repeat"></div>
              <small class="hint">Rows only render in the PDF when at least one field is filled.</small>
            </section>

            <!-- LEGAL -->
            <section class="tab" data-tab="legal" hidden>
              <h2>Legal (fully editable)</h2>
              <div class="grid2">
                <label class="field"><span>Heading</span><input name="legal.confidentialityHeading" /></label>
                <label class="field"><span>Contact name</span><input name="legal.contactName" /></label>
                <label class="field"><span>Contact email</span><input name="legal.contactEmail" /></label>
                <label class="field"><span>Contact phone</span><input name="legal.contactPhone" /></label>
              </div>
              <label class="field"><span>Confidentiality text</span><textarea name="legal.confidentialityBody" rows="10"></textarea></label>
              <label class="field"><span>Disclaimer text</span><textarea name="legal.disclaimerBody" rows="10"></textarea></label>
            </section>

            <!-- CONTENTS -->
            <section class="tab" data-tab="contents" hidden>
              <h2>Contents</h2>
              <p class="hint">
                The contents page is generated automatically from the sections that have content. No inputs required.
              </p>
            </section>

            <!-- EXEC SUMMARY -->
            <section class="tab" data-tab="exec" hidden>
              <div class="rowhead">
                <h2>Executive Summary</h2>
                <button type="button" class="btn btn-ghost" data-add="execSummary">+ Add</button>
              </div>
              <div id="execSummaryList" class="repeat"></div>
              <small class="hint">Key/value rows. Empty rows are ignored.</small>
            </section>

            <!-- PROPOSAL -->
            <section class="tab" data-tab="proposal" hidden>
              <h2>The Proposal</h2>
              <label class="field"><span>Synopsis</span><textarea name="proposal.synopsis" rows="8" placeholder=""></textarea></label>
              <label class="field"><span>Existing facilities</span><textarea name="proposal.existingFacilities" rows="6"></textarea></label>
              <label class="field"><span>Consultants (one per line)</span><textarea name="proposal.consultants" rows="6"></textarea></label>
            </section>

            <!-- SALES -->
            <section class="tab" data-tab="sales" hidden>
              <h2>Sales & Marketing</h2>
              <label class="field"><span>Sales strategy</span><textarea name="salesMarketing.salesStrategy" rows="6"></textarea></label>
              <label class="field"><span>Marketing strategy</span><textarea name="salesMarketing.marketingStrategy" rows="6"></textarea></label>
              <label class="field"><span>Presales summary</span><textarea name="salesMarketing.presalesSummary" rows="4"></textarea></label>

              <div class="rowhead" style="margin-top:14px;">
                <h3 style="margin:0;">Presales</h3>
                <button type="button" class="btn btn-ghost" data-add="presales">+ Add</button>
              </div>
              <div id="presalesList" class="repeat"></div>
            </section>

            <!-- PRICELIST -->
            <section class="tab" data-tab="lots" hidden>
              <div class="rowhead">
                <h2>Pricelist and lot sizes</h2>
                <button type="button" class="btn btn-ghost" data-add="lots">+ Add</button>
              </div>
              <div id="lotsList" class="repeat"></div>
            </section>

            <!-- PROPERTY -->
            <section class="tab" data-tab="property" hidden>
              <h2>Property Information</h2>
              <div class="grid2">
                <label class="field"><span>Address</span><input name="property.address" /></label>
                <label class="field"><span>Area</span><input name="property.area" /></label>
                <label class="field"><span>Zoning</span><input name="property.zoning" /></label>
                <label class="field"><span>Titles</span><input name="property.titles" /></label>
              </div>
              <label class="field"><span>Security description</span><textarea name="property.securityDescription" rows="5"></textarea></label>
              <label class="field"><span>Planning / DA</span><textarea name="property.planning" rows="5"></textarea></label>
              <label class="field"><span>Services / Utilities</span><textarea name="property.services" rows="4"></textarea></label>
              <label class="field"><span>Notes</span><textarea name="property.notes" rows="4"></textarea></label>

              <div class="field">
                <span>Property Images (up to 6)</span>
                <input type="file" accept="image/*" name="propertyImages" multiple />
                <small>Used in Property Images section. Optional.</small>
              </div>
            </section>

            <!-- FEASIBILITY -->
            <section class="tab" data-tab="feasibility" hidden>
              <div class="rowhead">
                <h2>Feasibility rows</h2>
                <button type="button" class="btn btn-ghost" data-add="feasibility">+ Add</button>
              </div>
              <div id="feasibilityList" class="repeat"></div>
              <small class="hint">Use group to control table grouping (e.g., Income, Costs, Funding).</small>
            </section>

            <!-- LOAN -->
            <section class="tab" data-tab="loan" hidden>
              <h2>The Loan</h2>
              <div class="grid2">
                <label class="field"><span>Loan amount</span><input name="loan.loanAmount" /></label>
                <label class="field"><span>Loan type</span><input name="loan.loanType" /></label>
                <label class="field"><span>LVR</span><input name="loan.lvr" /></label>
                <label class="field"><span>Term</span><input name="loan.term" /></label>
                <label class="field"><span>Security type</span><input name="loan.securityType" /></label>
                <label class="field"><span>Security location</span><input name="loan.securityLocation" /></label>
                <label class="field"><span>Credit reports</span><input name="loan.creditReports" /></label>
                <label class="field"><span>Anticipated settlement</span><input name="loan.anticipatedSettlement" /></label>
                <label class="field"><span>Exit strategy</span><input name="loan.exitStrategy" /></label>
              </div>
              <label class="field"><span>Loan purpose</span><textarea name="loan.purpose" rows="4"></textarea></label>
              <label class="field"><span>Pricing</span><textarea name="loan.pricing" rows="3"></textarea></label>
              <label class="field"><span>Fees</span><textarea name="loan.fees" rows="3"></textarea></label>
              <label class="field"><span>Additional terms</span><textarea name="loan.additionalTerms" rows="5"></textarea></label>
            </section>

            <!-- FUNDING -->
            <section class="tab" data-tab="funding" hidden>
              <div class="rowhead">
                <h2>Estimated Funding Position</h2>
                <button type="button" class="btn btn-ghost" data-add="funding">+ Add</button>
              </div>
              <div id="fundingList" class="repeat"></div>
              <label class="field"><span>Notes</span><textarea name="funding.notes" rows="4"></textarea></label>
            </section>

            <!-- SECURITY -->
            <section class="tab" data-tab="security" hidden>
              <div class="rowhead">
                <h2>Security Offered</h2>
                <button type="button" class="btn btn-ghost" data-add="security">+ Add</button>
              </div>
              <div id="securityList" class="repeat"></div>
              <label class="field"><span>Notes</span><textarea name="security.notes" rows="4"></textarea></label>
            </section>

            <!-- BORROWERS -->
            <section class="tab" data-tab="borrowers" hidden>
              <div class="rowhead">
                <h2>The Borrowers</h2>
                <button type="button" class="btn btn-ghost" data-add="borrowers">+ Add</button>
              </div>
              <div id="borrowersList" class="repeat"></div>
            </section>

            <!-- GUARANTORS -->
            <section class="tab" data-tab="guarantors" hidden>
              <div class="rowhead">
                <h2>Individuals & Guarantors</h2>
                <div class="rowhead-actions">
                  <button type="button" class="btn btn-ghost" data-add="guarantors">+ Add</button>
                  <span class="cap">min 1 • max 10</span>
                </div>
              </div>
              <div id="guarantorsList" class="repeat"></div>
            </section>

            <!-- FINANCIALS -->
            <section class="tab" data-tab="financials" hidden>
              <h2>Financial Information</h2>
              <div class="rowhead"><h3 style="margin:0;">Company assets</h3><button type="button" class="btn btn-ghost" data-add="companyAssets">+ Add</button></div>
              <div id="companyAssetsList" class="repeat"></div>

              <div class="rowhead" style="margin-top:14px;"><h3 style="margin:0;">Company liabilities</h3><button type="button" class="btn btn-ghost" data-add="companyLiabilities">+ Add</button></div>
              <div id="companyLiabilitiesList" class="repeat"></div>

              <label class="field" style="margin-top:14px;">
                <span>Individuals (simple format)</span>
                <textarea name="financialsIndividualsText" rows="10" placeholder="Name: John Smith\nAsset|Cash|$100,000\nLiability|Mortgage|$500,000\n\nName: Jane Smith\nAsset|Shares|$250,000"></textarea>
                <small>Parsed on export. Format: first line 'Name: ...', then lines 'Asset|Label|Amount' or 'Liability|Label|Amount'. Blank line separates people.</small>
              </label>
            </section>

            <!-- PROFESSIONAL CONTACTS -->
            <section class="tab" data-tab="professionalContacts" hidden>
              <h2>Professional Contacts</h2>
              <h3>Solicitor</h3>
              <div class="grid2">
                <label class="field"><span>Name</span><input name="professionalContacts.solicitor.name" /></label>
                <label class="field"><span>Firm</span><input name="professionalContacts.solicitor.firm" /></label>
                <label class="field"><span>Email</span><input name="professionalContacts.solicitor.email" /></label>
                <label class="field"><span>Phone</span><input name="professionalContacts.solicitor.phone" /></label>
              </div>
              <h3 style="margin-top:14px;">Accountant</h3>
              <div class="grid2">
                <label class="field"><span>Name</span><input name="professionalContacts.accountant.name" /></label>
                <label class="field"><span>Firm</span><input name="professionalContacts.accountant.firm" /></label>
                <label class="field"><span>Email</span><input name="professionalContacts.accountant.email" /></label>
                <label class="field"><span>Phone</span><input name="professionalContacts.accountant.phone" /></label>
              </div>
            </section>

            <!-- CONTACTS (BACK COVER) -->
            <section class="tab" data-tab="contacts" hidden>
              <h2>Contacts (Back Cover)</h2>
              <div class="grid2">
                <label class="field"><span>Company / Team</span><input name="backContacts.company" placeholder="Global Capital Commercial" /></label>
                <label class="field"><span>Website</span><input name="backContacts.website" placeholder="www..." /></label>
                <label class="field"><span>Email</span><input name="backContacts.email" placeholder="info@..." /></label>
                <label class="field"><span>Phone</span><input name="backContacts.phone" placeholder="(02)..." /></label>
              </div>
              <label class="field"><span>Address</span><textarea name="backContacts.address" rows="3" placeholder="Level ...\nStreet\nCity" ></textarea></label>
            </section>

            <!-- RECOMMENDATION -->
            <section class="tab" data-tab="recommendation" hidden>
              <h2>Recommendation &amp; Annexures (fully editable)</h2>
              <label class="field"><span>Heading</span><input name="recommendation.heading" /></label>
              <label class="field"><span>Body</span><textarea name="recommendation.body" rows="10"></textarea></label>
              <div class="grid2">
                <label class="field"><span>Annexures heading</span><input name="recommendation.annexuresHeading" /></label>
                <label class="field"><span>Annexures intro</span><textarea name="recommendation.annexuresIntro" rows="3"></textarea></label>
              </div>
              <label class="field"><span>Annexures (one per line)</span><textarea name="recommendation.annexuresList" rows="8"></textarea></label>
            </section>

            <!-- FOOTER -->
            <section class="tab" data-tab="footers" hidden>
              <h2>Footer (logo + text)</h2>
              <div class="grid2">
                <label class="field"><span>Footer logo (same on every page)</span><input type="file" name="footerLogo" accept="image/*" /></label>
                <label class="field"><span>Confidentiality line</span><input name="footers.confidentiality" /></label>
              </div>
              <label class="field"><span>Right side text (optional)</span><input name="footers.right" /></label>
            </section>
          </form>
        </section>
      </main>
    </div>

    <!-- Templates -->
    <template id="tplPartiesRow">
      <div class="repeat-row">
        <div class="grid3">
          <label class="field"><span>Name</span><input data-k="name" placeholder="Entity / Person" /></label>
          <label class="field"><span>Role</span><input data-k="role" placeholder="Borrower" /></label>
          <label class="field"><span>Entity Type</span><input data-k="entityType" placeholder="Company / Trust" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplExecSummaryRow">
      <div class="repeat-row">
        <div class="grid2">
          <label class="field"><span>Key</span><input data-k="key" placeholder="BORROWER" /></label>
          <label class="field"><span>Value</span><input data-k="value" placeholder="" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplPresalesRow">
      <div class="repeat-row">
        <div class="grid5">
          <label class="field"><span>Buyer</span><input data-k="buyer" /></label>
          <label class="field"><span>Lot</span><input data-k="lot" /></label>
          <label class="field"><span>Price</span><input data-k="price" /></label>
          <label class="field"><span>Deposit</span><input data-k="deposit" /></label>
          <label class="field"><span>Status</span><input data-k="status" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplLotsRow">
      <div class="repeat-row">
        <div class="grid5">
          <label class="field"><span>Stage</span><input data-k="stage" placeholder="Stage 1" /></label>
          <label class="field"><span>Lot</span><input data-k="lot" placeholder="Lot 12" /></label>
          <label class="field"><span>Size</span><input data-k="size" placeholder="450m²" /></label>
          <label class="field"><span>Price</span><input data-k="price" placeholder="$650,000" /></label>
          <label class="field"><span>Status</span><input data-k="status" placeholder="Available" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplFeasibilityRow">
      <div class="repeat-row">
        <div class="grid4">
          <label class="field"><span>Group</span><input data-k="group" placeholder="Costs" /></label>
          <label class="field"><span>Line item</span><input data-k="label" /></label>
          <label class="field"><span>Amount</span><input data-k="amount" /></label>
          <label class="field"><span>Notes</span><input data-k="notes" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplFundingRow">
      <div class="repeat-row">
        <div class="grid2">
          <label class="field"><span>Label</span><input data-k="label" /></label>
          <label class="field"><span>Amount</span><input data-k="amount" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplSecurityRow">
      <div class="repeat-row">
        <div class="grid2">
          <label class="field"><span>Name</span><input data-k="name" /></label>
          <label class="field"><span>Details</span><input data-k="details" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplBorrowersRow">
      <div class="repeat-row">
        <div class="grid3">
          <label class="field"><span>Name</span><input data-k="name" /></label>
          <label class="field"><span>Entity Type</span><input data-k="entityType" /></label>
          <label class="field"><span>ABN/ACN</span><input data-k="abn" /></label>
        </div>
        <div class="grid3">
          <label class="field"><span>Role</span><input data-k="role" /></label>
          <label class="field"><span>Address</span><input data-k="address" /></label>
          <label class="field"><span>Notes</span><input data-k="notes" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplGuarantorsRow">
      <div class="repeat-row">
        <div class="grid3">
          <label class="field"><span>Full Name</span><input data-k="fullName" /></label>
          <label class="field"><span>Relationship</span><input data-k="relationship" /></label>
          <label class="field"><span>Net Worth</span><input data-k="netWorth" /></label>
        </div>
        <label class="field"><span>Bio (optional)</span><textarea data-k="bio" rows="3"></textarea></label>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <template id="tplCompanyRow">
      <div class="repeat-row">
        <div class="grid2">
          <label class="field"><span>Label</span><input data-k="label" /></label>
          <label class="field"><span>Amount</span><input data-k="amount" /></label>
        </div>
        <div class="row-actions"><button type="button" class="btn btn-ghost" data-remove>Remove</button></div>
      </div>
    </template>

    <script src="app.js" defer></script>
  </body>
</html>
